<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Doctors - Hospital Management</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">üè• Hospital</div>
            <ul class="nav-links">
                <li><a href="/admin_dashboard.html">Dashboard</a></li>
                <li><a href="/doctors.html">Doctors</a></li>
                <li><a href="#" onclick="logout()">Logout</a></li>
            </ul>
        </div>
    </nav>

    <div class="dashboard">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Our Medical Team</h1>
            <p class="dashboard-subtitle">Meet our experienced and qualified doctors</p>
        </div>

        <!-- Search Section -->
        <div class="card">
            <div class="form-group">
                <label for="searchInput" class="form-label">Search Doctors</label>
                <input type="text" id="searchInput" class="form-input" 
                       placeholder="Search by name or specialty..." 
                       onkeyup="filterDoctors()">
            </div>
        </div>

        <!-- Doctors Grid -->
        <div class="doctors-grid" id="doctorsGrid">
            <div class="loading">Loading our amazing doctors...</div>
        </div>
    </div>

    <script src="/js/api.js"></script>
    <script>
        let allDoctors = [];

        // Load doctors on page load
        loadDoctors();

        async function loadDoctors() {
            try {
                allDoctors = await DoctorAPI.getAll();
                displayDoctors(allDoctors);
            } catch (error) {
                document.getElementById('doctorsGrid').innerHTML = 
                    '<div class="message message-error">Failed to load doctors</div>';
            }
        }

        function displayDoctors(doctors) {
            const grid = document.getElementById('doctorsGrid');
            
            if (doctors.length === 0) {
                grid.innerHTML = '<div class="card"><p>No doctors found</p></div>';
                return;
            }

            grid.innerHTML = doctors.map(doctor => `
                <div class="doctor-card">
                    <div class="doctor-image">
                        ${doctor.firstName.charAt(0)}${doctor.lastName.charAt(0)}
                    </div>
                    <div class="doctor-info">
                        <h3 class="doctor-name">Dr. ${doctor.firstName} ${doctor.lastName}</h3>
                        <p class="doctor-specialty">${doctor.specialty}</p>
                        <p class="doctor-email">${doctor.email}</p>
                        <button class="btn btn-primary btn-full" onclick="bookAppointment(${doctor.id})">
                            Book Appointment
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterDoctors() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm === '') {
                displayDoctors(allDoctors);
                return;
            }

            const filteredDoctors = allDoctors.filter(doctor => 
                doctor.firstName.toLowerCase().includes(searchTerm) ||
                doctor.lastName.toLowerCase().includes(searchTerm) ||
                doctor.specialty.toLowerCase().includes(searchTerm)
            );

            displayDoctors(filteredDoctors);
        }

        function bookAppointment(doctorId) {
            // Store selected doctor ID and redirect to booking page
            localStorage.setItem('selectedDoctorId', doctorId);
            window.location.href = '/book_appointment.html';
        }

        function logout() {
            localStorage.removeItem('user');
            window.location.href = '/login.html';
        }
    </script>
</body>
</html>